# Production Mode Configuration for Integration Tests
# Full database deployment including infrastructure and environment-specific settings

# CONNECTION SETTINGS
# Trust server certificate for Docker SQL Server 2022 with self-signed cert
trustServerCertificate: true

importMode: Prod
includeData: true

# Dependency retry settings
import:
  dependencyRetries:
    enabled: true
    maxRetries: 10
    objectTypes:
      - Functions
      - StoredProcedures
      - Views

  # Production mode settings
  productionMode:
    # Enable all infrastructure components for Prod
    includeFileGroups: true
    includeConfigurations: true
    includeDatabaseScopedCredentials: false  # Always false - secrets required
    includeExternalData: false  # Disabled for test environment
    enableSecurityPolicies: true

    # FileGroup path mapping for target environment
    # Base directory paths (without trailing separator) for each FileGroup
    # Script will automatically add correct path separator based on target OS
    # and append database-specific filenames to prevent conflicts
    fileGroupPathMapping:
      FG_CURRENT: "/var/opt/mssql/data"
      FG_ARCHIVE: "/var/opt/mssql/data"

    # FileGroup file size defaults for Prod mode (optional - uses source values if not specified)
    # For test environment, we use smaller sizes to avoid disk space issues
    fileGroupFileSizeDefaults:
      sizeKB: 2048        # 2 MB initial size
      fileGrowthKB: 65536   # 64 MB growth increment

# Prod mode includes:
# - FileGroups (with path mapping from above)
# - Database Scoped Configurations
# - Row-Level Security Policies
# - All schema objects
# - Data (if includeData: true)

# Always skipped (regardless of mode):
# - Database Scoped Credentials (secrets required)
# - External Data Sources (environment-specific connection strings)
